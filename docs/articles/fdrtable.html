<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating your own 'FDR' fixture table • fplscrapR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creating your own 'FDR' fixture table">
<meta property="og:description" content="fplscrapR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fplscrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/afdr.html">Creating an Alternative FDR' (aFDR) ranking of opponents by FPL points allowed</a>
    </li>
    <li>
      <a href="../articles/afdrtable.html">Creating an 'Alternative FDR' (aFDR) fixture table</a>
    </li>
    <li>
      <a href="../articles/allvignettes.html">All Vignettes</a>
    </li>
    <li>
      <a href="../articles/aubatransfers.html">Aubameyang ownership and net transfers for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="../articles/avgfplplayercost.html">Most expensive teams by average FPL player cost</a>
    </li>
    <li>
      <a href="../articles/bpsforgame.html">Comparing total team BPS scores for a given game</a>
    </li>
    <li>
      <a href="../articles/dgw32ppms.html">Top options by FPL points per 90 mins</a>
    </li>
    <li>
      <a href="../articles/entryscores.html">Average and top entry scores for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="../articles/fantasianplayingtime.html">Replicating Fantasian's playing time visualisation</a>
    </li>
    <li>
      <a href="../articles/fdrtable.html">Creating your own 'FDR' fixture table</a>
    </li>
    <li>
      <a href="../articles/findgoalscorers.html">Finding the names of goalscorers in a given fixture</a>
    </li>
    <li>
      <a href="../articles/fixtable.html">Creating a simple fixture table</a>
    </li>
    <li>
      <a href="../articles/hazalexishist.html">Comparing historical FPL total season scores for Mesut Özil and Juan Mata</a>
    </li>
    <li>
      <a href="../articles/listmyleagues.html">List your classic mini-leagues and current ranks</a>
    </li>
    <li>
      <a href="../articles/myxpts.html">My Expected Points</a>
    </li>
    <li>
      <a href="../articles/salahpoints.html">Mohamed Salah's points in each gameweek for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="../articles/simplexamodel.html">Building a very simple expected assists (xA) model</a>
    </li>
    <li>
      <a href="../articles/talismantheory.html">Replicating Who Got The Assist?'s Talisman Theory</a>
    </li>
    <li>
      <a href="../articles/topperformers.html">List of top performers by FPL goals and assists</a>
    </li>
    <li>
      <a href="../articles/vizentryhist.html">Visualizing the FPL histories of entries</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/wiscostret/fplscrapR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Creating your own ‘FDR’ fixture table</h1>
                        <h4 class="author">Rasmus Wiscostretford</h4>
            
            <h4 class="date">2021-08-14</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/wiscostret/fplscrapR/blob/master/vignettes/fdrtable.Rmd"><code>vignettes/fdrtable.Rmd</code></a></small>
      <div class="hidden name"><code>fdrtable.Rmd</code></div>

    </div>

    
    
<p>Suppose now we are interested in creating an FPL fixture table like the FPL’s official ‘Fixture Difficulty Ranking’? Let’s take the first 15 gameweeks of the season as an example.</p>
<p>First we fetch the official FDR rankings using get_fdr:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">fdr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_fdr.html">get_fdr</a></span>()</pre></body></html></div>
<p>Next we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">gamelist</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_game_list.html">get_game_list</a></span>()</pre></body></html></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">fdrfixtures</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">home</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"home"</span>),
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span>(<span class="no">home</span>),<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"away"</span>))</pre></body></html></div>
<p>Then we need to add in the FDR ranking for each fixture, doing so through a loop (which is decidedly not the most efficient method). For each row, we identify the data point in the fdr data frame that provides the FDR ranking for each team in question, depending on whether the fixture is home or away:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">fdrfixtures</span>)){
  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">fdrfixtures</span>$<span class="no">homeaway</span>[<span class="no">i</span>]<span class="kw">==</span><span class="st">"home"</span>,
    <span class="no">fdrfixtures</span>$<span class="no">fdr</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">fdr</span>$<span class="no">strength_overall_away</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">fdr</span>$<span class="no">short_name</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span>(<span class="no">fdrfixtures</span>$<span class="no">oppo</span>[<span class="no">i</span>]))],
    <span class="no">fdrfixtures</span>$<span class="no">fdr</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">fdr</span>$<span class="no">strength_overall_home</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">fdr</span>$<span class="no">short_name</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span>(<span class="no">fdrfixtures</span>$<span class="no">oppo</span>[<span class="no">i</span>]))])
}</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to plot the data in a fixture table:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="no">fdrfixtures</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">GW</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">15</span>) <span class="kw">%&gt;%</span>  <span class="co"># filtering for the gameweeks we are interested in</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">fdr</span>),<span class="kw">colour</span><span class="kw">=</span><span class="st">"lightgrey"</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">label</span><span class="kw">=</span><span class="no">oppo</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>)) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">margin</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">0</span>,-<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">0</span>))) + <span class="co"># fixing the margins</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">position</span><span class="kw">=</span><span class="st">"top"</span>,<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">15</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="kw">guide</span><span class="kw">=</span><span class="no">F</span>,<span class="kw">low</span><span class="kw">=</span><span class="st">"#00FF87"</span>,<span class="kw">mid</span><span class="kw">=</span><span class="st">"#D6DCD8"</span>,<span class="kw">high</span><span class="kw">=</span><span class="st">"#7F002D"</span>,<span class="kw">midpoint</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">fdrfixtures</span>$<span class="no">fdr</span>)) <span class="co"># creating a gradient colour-coding that spans from toughest FDR ranking (coloured red) to easiest (coloured green)</span></pre></body></html></div>
<p><img src="fdrtable_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Vignettes • fplscrapR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="All Vignettes">
<meta property="og:description" content="fplscrapR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fplscrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/afdr.html">Creating an Alternative FDR' (aFDR) ranking of opponents by FPL points allowed</a>
    </li>
    <li>
      <a href="../articles/afdrtable.html">Creating an 'Alternative FDR' (aFDR) fixture table</a>
    </li>
    <li>
      <a href="../articles/allvignettes.html">All Vignettes</a>
    </li>
    <li>
      <a href="../articles/aubatransfers.html">Aubameyang ownership and net transfers for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="../articles/avgfplplayercost.html">Most expensive teams by average FPL player cost</a>
    </li>
    <li>
      <a href="../articles/bpsforgame.html">Comparing total team BPS scores for a given game</a>
    </li>
    <li>
      <a href="../articles/dgw32ppms.html">Top options by FPL points per 90 mins</a>
    </li>
    <li>
      <a href="../articles/entryscores.html">Average and top entry scores for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="../articles/fantasianplayingtime.html">Replicating Fantasian's playing time visualisation</a>
    </li>
    <li>
      <a href="../articles/fdrtable.html">Creating your own 'FDR' fixture table</a>
    </li>
    <li>
      <a href="../articles/findgoalscorers.html">Finding the names of goalscorers in a given fixture</a>
    </li>
    <li>
      <a href="../articles/fixtable.html">Creating a simple fixture table</a>
    </li>
    <li>
      <a href="../articles/hazalexishist.html">Comparing historical FPL total season scores for Mesut Özil and Juan Mata</a>
    </li>
    <li>
      <a href="../articles/listmyleagues.html">List your classic mini-leagues and current ranks</a>
    </li>
    <li>
      <a href="../articles/myxpts.html">My Expected Points</a>
    </li>
    <li>
      <a href="../articles/salahpoints.html">Mohamed Salah's points in each gameweek for the first 25 gameweeks</a>
    </li>
    <li>
      <a href="../articles/simplexamodel.html">Building a very simple expected assists (xA) model</a>
    </li>
    <li>
      <a href="../articles/talismantheory.html">Replicating Who Got The Assist?'s Talisman Theory</a>
    </li>
    <li>
      <a href="../articles/topperformers.html">List of top performers by FPL goals and assists</a>
    </li>
    <li>
      <a href="../articles/vizentryhist.html">Visualizing the FPL histories of entries</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/wiscostret/fplscrapR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>All Vignettes</h1>
                        <h4 class="author">Rasmus Wiscostretford</h4>
            
            <h4 class="date">2021-08-14</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/wiscostret/fplscrapR/blob/master/vignettes/allvignettes.Rmd"><code>vignettes/allvignettes.Rmd</code></a></small>
      <div class="hidden name"><code>allvignettes.Rmd</code></div>

    </div>

    
    
<div id="creating-an-alternative-fdr-afdr-ranking-of-opponents-by-fpl-points-allowed" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-alternative-fdr-afdr-ranking-of-opponents-by-fpl-points-allowed" class="anchor"></a>Creating an Alternative FDR’ (aFDR) ranking of opponents by FPL points allowed</h2>
<p>Suppose now we are interested in trying to create an alternative to FPL’s “FDR” (Fixture Difficulty Ranking) based on actual FPL points allowed? Again, we take the first 25 gameweeks of the ’18/19 season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of ALL players using get_player_details:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>) <span class="co"># this may take a while to load as it fetches ALL player details</span></pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, ranking the teams by FPL points allowed:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">round</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filter out the gameweeks we are interested in</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">opponent_team</span>) <span class="kw">%&gt;%</span> <span class="co"># transformation to group and summarize the total_points (scored by a given player in a given round) by the opponent ('opponent_team') variable level</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">total_points</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">opponent_team</span>,<span class="no">`sum(total_points)`</span>),<span class="kw">y</span><span class="kw">=</span><span class="no">`sum(total_points)`</span>,<span class="kw">fill</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">opponent_team</span>))) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="kw">colour</span><span class="kw">=</span><span class="st">"black"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(<span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span><span class="kw">=</span><span class="st">"ARS"</span>,<span class="st">"2"</span><span class="kw">=</span><span class="st">"BOU"</span>,<span class="st">"3"</span><span class="kw">=</span><span class="st">"BHA"</span>,<span class="st">"4"</span><span class="kw">=</span><span class="st">"BUR"</span>,<span class="st">"5"</span><span class="kw">=</span><span class="st">"CAR"</span>,<span class="st">"6"</span><span class="kw">=</span><span class="st">"CHE"</span>,<span class="st">"7"</span><span class="kw">=</span><span class="st">"CRY"</span>,<span class="st">"8"</span><span class="kw">=</span><span class="st">"EVE"</span>,<span class="st">"9"</span><span class="kw">=</span><span class="st">"FUL"</span>,<span class="st">"10"</span><span class="kw">=</span><span class="st">"HUD"</span>,<span class="st">"11"</span><span class="kw">=</span><span class="st">"LEI"</span>,<span class="st">"12"</span><span class="kw">=</span><span class="st">"LIV"</span>,<span class="st">"13"</span><span class="kw">=</span><span class="st">"MCI"</span>,<span class="st">"14"</span><span class="kw">=</span><span class="st">"MUN"</span>,<span class="st">"15"</span><span class="kw">=</span><span class="st">"NEW"</span>,<span class="st">"16"</span><span class="kw">=</span><span class="st">"SOU"</span>,<span class="st">"17"</span><span class="kw">=</span><span class="st">"TOT"</span>,<span class="st">"18"</span><span class="kw">=</span><span class="st">"WAT"</span>,<span class="st">"19"</span><span class="kw">=</span><span class="st">"WHU"</span>,<span class="st">"20"</span><span class="kw">=</span><span class="st">"WOL"</span>)) + <span class="co"># here we transform the numbered team labels to the FPL short letter names</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Team"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Total FPL points allowed"</span>,<span class="kw">title</span><span class="kw">=</span><span class="st">"Alternative FDR ranking - by total FPL points allowed"</span>,<span class="kw">subtitle</span><span class="kw">=</span><span class="st">"Season 2018/2019 - Gameweeks 1-25"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span>(<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span><span class="kw">=</span><span class="st">"#EF0107"</span>,<span class="st">"2"</span><span class="kw">=</span><span class="st">"#000000"</span>,<span class="st">"3"</span><span class="kw">=</span><span class="st">"#0057B8"</span>,<span class="st">"4"</span><span class="kw">=</span><span class="st">"#6C1D45"</span>,<span class="st">"5"</span><span class="kw">=</span><span class="st">"#0070B5"</span>,<span class="st">"6"</span><span class="kw">=</span><span class="st">"#034694"</span>,<span class="st">"7"</span><span class="kw">=</span><span class="st">"#1B458F"</span>,<span class="st">"8"</span><span class="kw">=</span><span class="st">"#003399"</span>,<span class="st">"9"</span><span class="kw">=</span><span class="st">"#FFFFFF"</span>,<span class="st">"10"</span><span class="kw">=</span><span class="st">"#0E63AD"</span>,<span class="st">"11"</span><span class="kw">=</span><span class="st">"#003090"</span>,<span class="st">"12"</span><span class="kw">=</span><span class="st">"#C8102E"</span>,<span class="st">"13"</span><span class="kw">=</span><span class="st">"#6CABDD"</span>,<span class="st">"14"</span><span class="kw">=</span><span class="st">"#DA291C"</span>,<span class="st">"15"</span><span class="kw">=</span><span class="st">"#241F20"</span>,<span class="st">"16"</span><span class="kw">=</span><span class="st">"#D71920"</span>,<span class="st">"17"</span><span class="kw">=</span><span class="st">"#132257"</span>,<span class="st">"18"</span><span class="kw">=</span><span class="st">"#FBEE23"</span>,<span class="st">"19"</span><span class="kw">=</span><span class="st">"#7A263A"</span>,<span class="st">"20"</span><span class="kw">=</span><span class="st">"#FDB913"</span>),<span class="kw">guide</span><span class="kw">=</span><span class="no">F</span>) <span class="co"># here we add the team-specific colours to the plot</span></pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<hr>
</div>
<div id="creating-an-alternative-fdr-afdr-fixture-table" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-an-alternative-fdr-afdr-fixture-table" class="anchor"></a>Creating an ‘Alternative FDR’ (aFDR) fixture table</h2>
<p>Suppose now we are interested in creating an FPL fixture table that ranks fixtures by the ‘Alternative FDR’ (aFDR) metric? Again, we take the first 25 gameweeks of the ’18 season as an example.</p>
<p>First we create the aFDR rankings table, by fetching the gameweek-by-gameweek details of ALL players using get_player_details, and then transforming that using dplyr:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">season</span> <span class="kw">=</span> <span class="fl">18</span>) <span class="co"># this may take a while to load as it fetches ALL player details</span>

<span class="no">afdrranks</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">round</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for the gameweeks we are interested in.</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">opponent_team</span>) <span class="kw">%&gt;%</span> <span class="co"># transformation to group and summarize the total_points (scored by a given player in a given round) by the opponent ('opponent_team') variable level</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">total_points</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">`sum(total_points)`</span>) <span class="kw">%&gt;%</span> <span class="co"># ordering (arranging) by total_points allowed</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">oppo</span><span class="kw">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span>(<span class="no">opponent_team</span>,<span class="st">"1"</span><span class="kw">=</span><span class="st">"ARS"</span>,<span class="st">"2"</span><span class="kw">=</span><span class="st">"BOU"</span>,<span class="st">"3"</span><span class="kw">=</span><span class="st">"BHA"</span>,<span class="st">"4"</span><span class="kw">=</span><span class="st">"BUR"</span>,<span class="st">"5"</span><span class="kw">=</span><span class="st">"CAR"</span>,<span class="st">"6"</span><span class="kw">=</span><span class="st">"CHE"</span>,<span class="st">"7"</span><span class="kw">=</span><span class="st">"CRY"</span>,<span class="st">"8"</span><span class="kw">=</span><span class="st">"EVE"</span>,<span class="st">"9"</span><span class="kw">=</span><span class="st">"FUL"</span>,<span class="st">"10"</span><span class="kw">=</span><span class="st">"HUD"</span>,<span class="st">"11"</span><span class="kw">=</span><span class="st">"LEI"</span>,<span class="st">"12"</span><span class="kw">=</span><span class="st">"LIV"</span>,<span class="st">"13"</span><span class="kw">=</span><span class="st">"MCI"</span>,<span class="st">"14"</span><span class="kw">=</span><span class="st">"MUN"</span>,<span class="st">"15"</span><span class="kw">=</span><span class="st">"NEW"</span>,<span class="st">"16"</span><span class="kw">=</span><span class="st">"SOU"</span>,<span class="st">"17"</span><span class="kw">=</span><span class="st">"TOT"</span>,<span class="st">"18"</span><span class="kw">=</span><span class="st">"WAT"</span>,<span class="st">"19"</span><span class="kw">=</span><span class="st">"WHU"</span>,<span class="st">"20"</span><span class="kw">=</span><span class="st">"WOL"</span>)) <span class="co"># here we transform the numbered team labels to the FPL short letter names</span></pre></body></html></div>
<p>Next, we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">gamelist</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_game_list.html">get_game_list</a></span>(<span class="kw">season</span> <span class="kw">=</span> <span class="fl">18</span>)</pre></body></html></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">afdrfixtures</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">home</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"home"</span>),
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span>(<span class="no">home</span>),<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"away"</span>))</pre></body></html></div>
<p>Then we need to add in the aFDR ranking for each fixture, doing so through a loop (which is decidedly not the most efficient method). For each row, we identify the data point in the afdrranks data frame that provides the aFDR ranking for each team in question:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">afdrfixtures</span>)){
  <span class="no">afdrfixtures</span>$<span class="no">afdr</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">afdrranks</span>$<span class="no">`sum(total_points)`</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">afdrranks</span>$<span class="no">oppo</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span>(<span class="no">afdrfixtures</span>$<span class="no">oppo</span>[<span class="no">i</span>]))]
}</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to plot the data in a fixture table:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="no">afdrfixtures</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">GW</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for the gameweeks we are interested in </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">afdr</span>),<span class="kw">colour</span><span class="kw">=</span><span class="st">"lightgrey"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">label</span><span class="kw">=</span><span class="no">oppo</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">margin</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">0</span>,-<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">0</span>))) + <span class="co"># fixing the margins</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">position</span><span class="kw">=</span><span class="st">"top"</span>,<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">25</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="kw">guide</span><span class="kw">=</span><span class="no">F</span>,<span class="kw">low</span><span class="kw">=</span><span class="st">"#00FF87"</span>,<span class="kw">mid</span><span class="kw">=</span><span class="st">"#D6DCD8"</span>,<span class="kw">high</span><span class="kw">=</span><span class="st">"#7F002D"</span>,<span class="kw">midpoint</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">afdrfixtures</span>$<span class="no">afdr</span>)) <span class="co"># creating a gradient colour-coding that spans from lowest aFDR ranking (coloured red) to highest (coloured green)</span></pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<hr>
</div>
<div id="aubameyang-ownership-and-net-transfers-for-the-first-25-gameweeks" class="section level2">
<h2 class="hasAnchor">
<a href="#aubameyang-ownership-and-net-transfers-for-the-first-25-gameweeks" class="anchor"></a>Aubameyang ownership and net transfers for the first 25 gameweeks</h2>
<p>Suppose we are interested in how the ownership of Pierre-Emerick Aubameyang has changed through transfers over the course of the first 25 gameweeks of the 18/19 season?</p>
<p>First we fetch the gameweek-by-gameweek details of the player using get_player_details, mobilising the playerid using get_player_id:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Pierre-Emerick Aubameyang"</span>,<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>)</pre></body></html></div>
<p>Next we use dplyr, tidyr and ggplot2 to transform and plot the data, showing the total number of owners and net transfers out for each gameweek:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">round</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for the GWs we are interested in</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">round</span>,<span class="no">transfers_balance</span>,<span class="no">selected</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the relevant columns</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="st">"var"</span>,<span class="st">"value"</span>,-<span class="no">round</span>) <span class="kw">%&gt;%</span> <span class="co"># transforming from wide to long format for ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() + <span class="co"># plotting using ggplot2</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">round</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">value</span>,<span class="kw">group</span><span class="kw">=</span><span class="no">var</span>,<span class="kw">colour</span><span class="kw">=</span><span class="no">var</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">25</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Gameweek"</span>,<span class="kw">title</span><span class="kw">=</span><span class="st">"Aubameyang ownership and net transfers"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<hr>
</div>
<div id="most-expensive-teams-by-average-fpl-player-cost" class="section level2">
<h2 class="hasAnchor">
<a href="#most-expensive-teams-by-average-fpl-player-cost" class="anchor"></a>Most expensive teams by average FPL player cost</h2>
<p>Suppose we are interested in comparing which Premier League teams have the most expensive FPL players on average?</p>
<p>First we fetch the full summary data on all FPL players using the get_player_info function:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_info.html">get_player_info</a></span>()</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, ranking each Premier League by its average FPL player cost:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">id</span>, <span class="no">team</span>, <span class="no">now_cost</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the relevant columns</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">now_cost</span><span class="kw">=</span><span class="no">now_cost</span>/<span class="fl">10</span>) <span class="kw">%&gt;%</span> <span class="co"># transforming the cost to millions (for some reason the FPL data structures FPL cost as 100.000s)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">team</span>) <span class="kw">%&gt;%</span> <span class="co"># transformation to group and mean-summarize the costs at the 'team' variable level </span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">mean</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">now_cost</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">teamshort</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_fdr.html">get_fdr</a></span>()$<span class="no">short_name</span>) <span class="kw">%&gt;%</span> <span class="co"># using the short team names from the get_fdr function instead of codes %&gt;% </span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(-<span class="no">mean</span>) <span class="kw">%&gt;%</span> <span class="co"># arranging by the mean cost</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() + <span class="co"># plotting using ggplot2</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">teamshort</span>,-<span class="no">mean</span>),<span class="kw">y</span><span class="kw">=</span><span class="no">mean</span>),<span class="kw">fill</span><span class="kw">=</span><span class="st">"blue"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Team"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Mean player cost (£m)"</span>,
      <span class="kw">title</span><span class="kw">=</span><span class="st">"Mean FPL player cost for Premier League teams"</span>,
      <span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<hr>
</div>
<div id="comparing-total-team-bps-scores-for-a-given-game" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-total-team-bps-scores-for-a-given-game" class="anchor"></a>Comparing total team BPS scores for a given game</h2>
<p>Suppose now we are interested in comparing the total BPS scores for each team in a given game? Here we take the example of game ID 1.</p>
<p>First we fetch the game stats using get_game_stats:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_game_stats.html">get_game_stats</a></span>(<span class="kw">gameid</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>Next we structure a coherent data frame of the two teams’ total BPS points, using R base’s rbind and dplyr:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>( <span class="co"># combining the two objects containing the home and away team's BPS points</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">df</span>$<span class="no">a</span><span class="kw">[[</span><span class="fl">10</span>]],<span class="kw">team</span><span class="kw">=</span><span class="st">"away"</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">df</span>$<span class="no">h</span><span class="kw">[[</span><span class="fl">10</span>]],<span class="kw">team</span><span class="kw">=</span><span class="st">"home"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">team</span>) <span class="kw">%&gt;%</span> <span class="co"># transformation to group and summarize the value (bps points scored by a given player in the game) at the team variable level</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">value</span>))</pre></body></html></div>
<pre><code>## # A tibble: 2 x 2
##   team  `sum(value)`
##   &lt;chr&gt;        &lt;int&gt;
## 1 away           129
## 2 home           218</code></pre>
<hr>
</div>
<div id="top-options-by-fpl-points-per-90-mins" class="section level2">
<h2 class="hasAnchor">
<a href="#top-options-by-fpl-points-per-90-mins" class="anchor"></a>Top options by FPL points per 90 mins</h2>
<p>Suppose we are interested in the top options from ’18/19, measured by FPL points per 90 mins (pp90)?</p>
<p>With fplscrapR, we can do that just a few lines of code:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_info.html">get_player_info</a></span>(<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>)

<span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">total_points</span> <span class="kw">&gt;=</span> <span class="fl">30</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for players with more than 30 points scored</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">pp90</span> <span class="kw">=</span> <span class="no">total_points</span> / <span class="no">minutes</span> * <span class="fl">90</span>) <span class="kw">%&gt;%</span> <span class="co"># creating the 'pp90' variable</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">playername</span>,<span class="no">pp90</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting player name and pp90 for our table</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(-<span class="no">pp90</span>) <span class="kw">%&gt;%</span> <span class="co"># ordering (arranging) by pp90</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="fl">1</span>:<span class="fl">20</span>) <span class="co"># showing just the top20</span></pre></body></html></div>
<pre><code>##                   playername     pp90
## 1               Divock Origi 7.912088
## 2            Raheem Sterling 7.602888
## 3                 Leroy Sané 7.560582
## 4            Xherdan Shaqiri 7.528517
## 5              Sergio Agüero 7.362637
## 6                Eden Hazard 7.340644
## 7         Ruben Loftus-Cheek 7.255102
## 8              Mohamed Salah 7.163491
## 9              Heung-Min Son 7.038859
## 10 Gabriel Fernando de Jesus 6.991150
## 11              Riyad Mahrez 6.897070
## 12           Anthony Martial 6.807192
## 13 Pierre-Emerick Aubameyang 6.778104
## 14    Trent Alexander-Arnold 6.768293
## 15                Sadio Mané 6.758778
## 16               Lucas Pérez 6.387097
## 17            Ivan Cavaleiro 6.381093
## 18               Erik Lamela 6.248705
## 19              Aaron Ramsey 6.209249
## 20          Daniel Sturridge 6.144578</code></pre>
<hr>
</div>
<div id="average-and-top-entry-scores-for-the-first-25-gameweeks" class="section level2">
<h2 class="hasAnchor">
<a href="#average-and-top-entry-scores-for-the-first-25-gameweeks" class="anchor"></a>Average and top entry scores for the first 25 gameweeks</h2>
<p>Suppose we are interested in tracking the average and top FPL scores by gameweek?</p>
<p>First we fetch the round information for a selection of gameweeks, say 1-25 for the 18/19 season, using the get_round_info function:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_round_info.html">get_round_info</a></span>(<span class="kw">round</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">25</span>, <span class="kw">season</span> <span class="kw">=</span> <span class="fl">18</span>)</pre></body></html></div>
<p>Next we use dplyr, tidyr and ggplot2 to transform and plot the data, showing the average and top entry progression by gameweek:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">id</span>,<span class="no">average_entry_score</span>,<span class="no">highest_score</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the relevant columns</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="st">"var"</span>,<span class="st">"value"</span>,-<span class="no">id</span>) <span class="kw">%&gt;%</span> <span class="co"># transforming from wide to long format for ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() + <span class="co"># plotting using ggplot2</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">id</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">value</span>,<span class="kw">colour</span><span class="kw">=</span><span class="no">var</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">25</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Gameweek"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Score"</span>,<span class="kw">title</span><span class="kw">=</span><span class="st">"Average and top FPL entry scores by gameweek"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<hr>
</div>
<div id="replicating-fantasians-playing-time-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#replicating-fantasians-playing-time-visualisation" class="anchor"></a>Replicating Fantasian’s playing time visualisation</h2>
<p>Suppose we are interested in replicating <a href="https://twitter.com/FantasianPL">Fantasian’s</a> visualisation of playing time?</p>
<p>With fplscrapR, it’s just a few lines of code away. Here, we take the example of Tottenham players across the whole 18/19 season.</p>
<p>First, we fetch the player stats using get_player_details:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">season</span> <span class="kw">=</span> <span class="fl">18</span>)</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data in a ‘tile’ format, showing the playing time for each player across gameweeks:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">element</span> <span class="kw">%in%</span> <span class="fl">351</span>:<span class="fl">372</span>) <span class="kw">%&gt;%</span>  <span class="co"># selecting the 'elements' (players) from Tottenham</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">round</span>,<span class="kw">y</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">playername</span>,-<span class="no">element</span>),<span class="kw">fill</span><span class="kw">=</span><span class="no">minutes</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">position</span><span class="kw">=</span><span class="st">"top"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Gameweek"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Player"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="kw">guide</span><span class="kw">=</span><span class="no">F</span>,<span class="kw">low</span><span class="kw">=</span><span class="st">"#FFFFFF"</span>,<span class="kw">high</span><span class="kw">=</span><span class="st">"#132257"</span>) <span class="co"># filling each tile based on the 'minutes' value, from 'low' (white) to 'high' (the 'Spurs blue')</span></pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<hr>
</div>
<div id="creating-your-own-fdr-fixture-table" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-your-own-fdr-fixture-table" class="anchor"></a>Creating your own ‘FDR’ fixture table</h2>
<p>Suppose now we are interested in creating an FPL fixture table like the FPL’s official ‘Fixture Difficulty Ranking’? Let’s take the first 15 gameweeks of the season as an example.</p>
<p>First we fetch the official FDR rankings using get_fdr:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">fdr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_fdr.html">get_fdr</a></span>()</pre></body></html></div>
<p>Next we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">gamelist</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_game_list.html">get_game_list</a></span>()</pre></body></html></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">fdrfixtures</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">home</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"home"</span>),
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span>(<span class="no">home</span>),<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"away"</span>))</pre></body></html></div>
<p>Then we need to add in the FDR ranking for each fixture, doing so through a loop (which is decidedly not the most efficient method). For each row, we identify the data point in the fdr data frame that provides the FDR ranking for each team in question, depending on whether the fixture is home or away:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">fdrfixtures</span>)){
  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">fdrfixtures</span>$<span class="no">homeaway</span>[<span class="no">i</span>]<span class="kw">==</span><span class="st">"home"</span>,
    <span class="no">fdrfixtures</span>$<span class="no">fdr</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">fdr</span>$<span class="no">strength_overall_away</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">fdr</span>$<span class="no">short_name</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span>(<span class="no">fdrfixtures</span>$<span class="no">oppo</span>[<span class="no">i</span>]))],
    <span class="no">fdrfixtures</span>$<span class="no">fdr</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">fdr</span>$<span class="no">strength_overall_home</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">fdr</span>$<span class="no">short_name</span><span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span>(<span class="no">fdrfixtures</span>$<span class="no">oppo</span>[<span class="no">i</span>]))])
}</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to plot the data in a fixture table:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="no">fdrfixtures</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">GW</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">15</span>) <span class="kw">%&gt;%</span>  <span class="co"># filtering for the gameweeks we are interested in</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">fdr</span>),<span class="kw">colour</span><span class="kw">=</span><span class="st">"lightgrey"</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">label</span><span class="kw">=</span><span class="no">oppo</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>)) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">margin</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">0</span>,-<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">0</span>))) + <span class="co"># fixing the margins</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">position</span><span class="kw">=</span><span class="st">"top"</span>,<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">15</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span>(<span class="kw">guide</span><span class="kw">=</span><span class="no">F</span>,<span class="kw">low</span><span class="kw">=</span><span class="st">"#00FF87"</span>,<span class="kw">mid</span><span class="kw">=</span><span class="st">"#D6DCD8"</span>,<span class="kw">high</span><span class="kw">=</span><span class="st">"#7F002D"</span>,<span class="kw">midpoint</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">fdrfixtures</span>$<span class="no">fdr</span>)) <span class="co"># creating a gradient colour-coding that spans from toughest FDR ranking (coloured red) to easiest (coloured green)</span></pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
<hr>
</div>
<div id="finding-the-names-of-goalscorers-in-a-given-fixture" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-the-names-of-goalscorers-in-a-given-fixture" class="anchor"></a>Finding the names of goalscorers in a given fixture</h2>
<p>Suppose now we are interested in finding the names of the goalscorers in a given game? Here we take the example of the first fixture of the season.</p>
<p>First we fetch the game stats using get_game_stats:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_game_stats.html">get_game_stats</a></span>(<span class="kw">gameid</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p>Next we identify the goalscorers’ playerids:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">goalscorerids</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">df</span>$<span class="no">a</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">element</span>,<span class="no">df</span>$<span class="no">h</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">element</span>))</pre></body></html></div>
<p>Finally we fetch the playernames of goalscorers using get_player_name:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="../reference/get_player_name.html">get_player_name</a></span>(<span class="kw">playerid</span><span class="kw">=</span><span class="no">goalscorerids</span>)</pre></body></html></div>
<pre><code>##           playername id
## 1 Christian Nørgaard 77
## 2        Sergi Canós 81</code></pre>
<hr>
</div>
<div id="creating-a-simple-fixture-table" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-simple-fixture-table" class="anchor"></a>Creating a simple fixture table</h2>
<p>Suppose now we are interested in creating a simple overview of FPL fixtures? Again, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the full fixture list using get_game_list:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">gamelist</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_game_list.html">get_game_list</a></span>()</pre></body></html></div>
<p>FPL only lists the fixtures once, as HOME-AWAY, but we need both HOME-AWAY and AWAY-HOME to plot the full fixture table. We need to plot every fixture twice, once as a home game for the one team, and once as an away game for the other team.</p>
<p>Using R base’s rbind and dplyr’s mutate (creating new variables) we essentially just duplicate the fixture table:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">allfixtures</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">home</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"home"</span>),
  <span class="no">gamelist</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">team</span><span class="kw">=</span><span class="no">away</span>,<span class="kw">oppo</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span>(<span class="no">home</span>),<span class="kw">homeaway</span><span class="kw">=</span><span class="st">"away"</span>))</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, ranking the teams by FPL points allowed:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="no">allfixtures</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">GW</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for the gameweeks we are interested in</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>),<span class="kw">fill</span><span class="kw">=</span><span class="st">"white"</span>,<span class="kw">colour</span><span class="kw">=</span><span class="st">"lightgrey"</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">GW</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">team</span>,<span class="kw">label</span><span class="kw">=</span><span class="no">oppo</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">face</span> <span class="kw">=</span> <span class="st">"bold"</span>)) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">margin</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">0</span>,-<span class="fl">20</span>,<span class="fl">0</span>,<span class="fl">0</span>))) + <span class="co"># fixing the margins on the tile</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">position</span><span class="kw">=</span><span class="st">"top"</span>,<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">25</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-37-1.png" width="672"></p>
<hr>
</div>
<div id="comparing-historical-fpl-total-season-scores-for-mesut-özil-and-juan-mata" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-historical-fpl-total-season-scores-for-mesut-%C3%B6zil-and-juan-mata" class="anchor"></a>Comparing historical FPL total season scores for Mesut Özil and Juan Mata</h2>
<p>Suppose we are interested in how the FPL histories of Mesut Özil and Juan Mata compare?</p>
<p>First we fetch the player histories of those two players using get_player_hist, mobilising their playerids using get_player_id:</p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_hist.html">get_player_hist</a></span>(<span class="kw">playerid</span><span class="kw">=</span><span class="fu"><a href="../reference/get_player_id.html">get_player_id</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Mesut Özil"</span>,<span class="st">"Juan Mata"</span>))$<span class="no">id</span>)</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, showing the total FPL scores by season for the two players across their FPL careers:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">playername</span>,<span class="no">season_name</span>,<span class="no">total_points</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the relevant columns</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() + <span class="co"># plotting using ggplot2</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">season_name</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">total_points</span>,<span class="kw">group</span><span class="kw">=</span><span class="no">playername</span>,<span class="kw">colour</span><span class="kw">=</span><span class="no">playername</span>),<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Season"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Total score"</span>,<span class="kw">title</span><span class="kw">=</span><span class="st">"Historical FPL season scores by Özil and Mata"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-40-1.png" width="672"></p>
<hr>
</div>
<div id="list-your-classic-mini-leagues-and-current-ranks" class="section level2">
<h2 class="hasAnchor">
<a href="#list-your-classic-mini-leagues-and-current-ranks" class="anchor"></a>List your classic mini-leagues and current ranks</h2>
<p>Suppose now we are interested in listing the classic mini-leagues of which you are a member and your current rank in those mini-leagues?</p>
<p>First we fetch the entry information using get_entry:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_entry.html">get_entry</a></span>(<span class="kw">entryid</span><span class="kw">=</span><span class="fl">1076</span>)</pre></body></html></div>
<p>Next we select the classic league details and the relevant data columns using dplyr:</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span>$<span class="no">leagues</span>$<span class="no">classic</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">name</span>,<span class="no">entry_last_rank</span>) <span class="co"># selecting the columns of interest here</span></pre></body></html></div>
<pre><code>##                             name entry_last_rank
## 1                        Arsenal               0
## 2                    Netherlands               0
## 3                     Gameweek 1               0
## 4                        Overall               0
## 5        youtube.com/letstalkfpl               0
## 6 @FPLHINTS (No Room for Racism)               0
## 7               FPLSwedes league               0
## 8             Randolph FPL 21-22               0
## 9                    Reev League               0</code></pre>
<hr>
</div>
<div id="my-expected-points" class="section level2">
<h2 class="hasAnchor">
<a href="#my-expected-points" class="anchor"></a>My Expected Points</h2>
<p>Suppose we are interested in how many points our team is expected to score in the next GW?</p>
<p>With fplscrapR, it’s just a few lines of code away.</p>
<p>First, we fetch the player selection using get_entry_picks. Here I use the example of random team for GW2.</p>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">picks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_entry_picks.html">get_entry_picks</a></span>(<span class="kw">entryid</span><span class="kw">=</span><span class="fl">1076</span>,<span class="kw">gw</span><span class="kw">=</span><span class="fl">1</span>)$<span class="no">picks</span></pre></body></html></div>
<p>Next we fetch the Official FPL Expected Points projections using get_player_info() and select only what we need: the player id (renamed ‘element’ for merging later), the player name, and the expected points projection (‘ep_next’), which we indicate is a numeric vector.</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_info.html">get_player_info</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">id</span>,<span class="no">playername</span>,<span class="no">ep_next</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="st">"element"</span><span class="kw">=</span><span class="no">id</span>)

<span class="no">df</span>$<span class="no">ep_next</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">df</span>$<span class="no">ep_next</span>)</pre></body></html></div>
<p>Finally we merge the two, select out the variables of interest, display the projections, and sum up the total expected points from our starting 11:</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">df2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(<span class="no">picks</span>,<span class="no">df</span>,<span class="kw">by</span><span class="kw">=</span><span class="st">"element"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">playername</span>,<span class="no">is_captain</span>,<span class="no">is_vice_captain</span>,<span class="no">ep_next</span>)

<span class="no">df2</span></pre></body></html></div>
<pre><code>##                       playername is_captain is_vice_captain ep_next
## 1                 Robert Sánchez      FALSE           FALSE     2.3
## 2                      Luke Shaw      FALSE           FALSE     3.1
## 3         Trent Alexander-Arnold      FALSE           FALSE     5.0
## 4          Konstantinos Tsimikas      FALSE           FALSE     2.0
## 5                  Harvey Barnes      FALSE           FALSE     2.4
## 6                  Mohamed Salah       TRUE           FALSE     5.0
## 7  Bruno Miguel Borges Fernandes      FALSE            TRUE     4.4
## 8                Mason Greenwood      FALSE           FALSE     3.0
## 9           Raphael Dias Belloli      FALSE           FALSE     2.2
## 10               Michail Antonio      FALSE           FALSE     2.4
## 11                    Danny Ings      FALSE           FALSE     3.0
## 12                    Ben Foster      FALSE           FALSE     0.5
## 13                     Ben White      FALSE           FALSE     1.7
## 14                   Luke Ayling      FALSE           FALSE     1.7
## 15                  Stipe Perica      FALSE           FALSE     0.5</code></pre>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">df2</span>$<span class="no">ep_next</span>[<span class="fl">1</span>:<span class="fl">11</span>])</pre></body></html></div>
<pre><code>## [1] 34.8</code></pre>
<hr>
</div>
<div id="mohamed-salahs-points-in-each-gameweek-for-the-first-25-gameweeks" class="section level2">
<h2 class="hasAnchor">
<a href="#mohamed-salahs-points-in-each-gameweek-for-the-first-25-gameweeks" class="anchor"></a>Mohamed Salah’s points in each gameweek for the first 25 gameweeks</h2>
<p>Suppose we are interested in the progression and variance of Mohamed Salah’s FPL score in each gameweek in ’18/19? Here, we take the first 25 gameweeks of the season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of the player using get_player_details, mobilising the playerid using get_player_id:</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"Mohamed Salah"</span>,<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>)</pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, showing Salah’s round score for each gameweek:</p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">round</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for the GWs we are interested in</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">round</span>,<span class="no">total_points</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the relevant columns</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() + <span class="co"># plotting with ggplot2</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">round</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">total_points</span>),<span class="kw">fill</span><span class="kw">=</span><span class="st">"red"</span>,<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">breaks</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">25</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Gameweek"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Round score"</span>,<span class="kw">title</span><span class="kw">=</span><span class="st">"Salah's round score by gameweek"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-48-1.png" width="672"></p>
<hr>
</div>
<div id="building-a-very-simple-expected-assists-xa-model" class="section level2">
<h2 class="hasAnchor">
<a href="#building-a-very-simple-expected-assists-xa-model" class="anchor"></a>Building a very simple expected assists (xA) model</h2>
<p>Suppose we are interested in trying to build an ‘expected assists’ (xA) model from the FPL data? Again, we take the first 25 gameweeks of the 18/19 season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of ALL players using get_player_details, then create our model dataset by selected information that could predict assist performance, such as Key Passes and Open Play Crosses:</p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>) <span class="co"># this may take a while to load as it fetches ALL player details</span>

<span class="no">dfmodel</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">round</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering out the rounds we are interested in</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">potentialassists</span> <span class="kw">=</span> <span class="no">key_passes</span>+<span class="no">open_play_crosses</span>) <span class="kw">%&gt;%</span> <span class="co"># creating a new variable that give us a potential indicator for expected assists, namely the number of key passes and open play crosses for each player</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">playername</span>,<span class="no">assists</span>,<span class="no">potentialassists</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the variables we need for our analysis</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">playername</span>) <span class="kw">%&gt;%</span> <span class="co"># transformation to group and summarize all our variables (i.e. the actual and potential assists) at the 'playername' variable level</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all</a></span>(<span class="no">sum</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">xA</span><span class="kw">=</span><span class="no">potentialassists</span>*(<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">assists</span>)/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">potentialassists</span>))) <span class="co"># creating a new variable called 'xA' that attempts to predict the actual number of assists based on the relationship (from our data) between the number of assists and key passes+open play cross a player has produced</span></pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, comparing the actual FPL assists with our ‘xA’ model predictions. We also use the ‘ggrepel’ package to avoid cluttering of our plot:</p>
<div class="sourceCode" id="cb57"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggrepel</span>)</pre></body></html></div>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="no">dfmodel</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">xA</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">assists</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.5</span>,<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Expected assists"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Actual assists"</span>,<span class="kw">title</span><span class="kw">=</span><span class="st">"Expected vs. actual assists"</span>,<span class="kw">subtitle</span><span class="kw">=</span><span class="st">"Season 2018/2019 - Gameweeks 1-25"</span>, <span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span>(<span class="kw">intercept</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">slope</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">colour</span><span class="kw">=</span><span class="st">"grey"</span>,<span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">3.75</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(
  <span class="kw">label</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">xA</span><span class="kw">&gt;</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">xA</span>,<span class="kw">prob</span><span class="kw">=</span><span class="fl">1</span>-<span class="fl">1.5</span>/<span class="fl">100</span>),<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">playername</span>),<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">assists</span><span class="kw">&gt;</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">assists</span>,<span class="kw">prob</span><span class="kw">=</span><span class="fl">1</span>-<span class="fl">1.5</span>/<span class="fl">100</span>),<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">playername</span>),<span class="st">""</span>)))) + <span class="co">#</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">limits</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">12</span>),<span class="kw">breaks</span><span class="kw">=</span><span class="fl">0</span>:<span class="fl">12</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">limits</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">12</span>),<span class="kw">breaks</span><span class="kw">=</span><span class="fl">0</span>:<span class="fl">12</span>)</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-51-1.png" width="672"></p>
<p>Here we can see that there is a significant variation around our expected assists. Ryan Fraser’s ouput is, for instance, well predicted. Raheem Sterling and Leroy Sanés are not - the model firmly under-estimates their assists. Meanwhile, the assists of players like Lucas Digne and Andros Townsend are far over-estimated.</p>
<p>Finally, we test our xA model to see how it fares in explaining the variation of actual assists, using the summary function from R base:</p>
<div class="sourceCode" id="cb59"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">dfmodel</span>,<span class="kw">formula</span><span class="kw">=</span><span class="no">xA</span> ~ <span class="no">assists</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = xA ~ assists, data = dfmodel)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8933 -0.4290 -0.3280  0.2436  5.1990 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.42900    0.04669   9.189   &lt;2e-16 ***
## assists      0.58220    0.02219  26.237   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9957 on 595 degrees of freedom
## Multiple R-squared:  0.5364, Adjusted R-squared:  0.5356 
## F-statistic: 688.4 on 1 and 595 DF,  p-value: &lt; 2.2e-16</code></pre>
<hr>
</div>
<div id="replicating-who-got-the-assists-talisman-theory" class="section level2">
<h2 class="hasAnchor">
<a href="#replicating-who-got-the-assists-talisman-theory" class="anchor"></a>Replicating Who Got The Assist?’s Talisman Theory</h2>
<p>Suppose we are interested in replicating ‘Who Got The Assist?’s famous ’Talisman Theory’ analysis for the 18/19 season, looking at the ‘key men’ for Premier League teams, players who score the largest proportion of team points. Specifically, selected non-appearance points that can be attributed to the individual player rather than the team as a whole.</p>
<p>With fplscrapR, we can do this analysis very easily.</p>
<p>First, we fetch the player stats using get_player_info:</p>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_info.html">get_player_info</a></span>(<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>)</pre></body></html></div>
<p>Next we manipulate the data frame to represent our needs in several steps, using dplyr:</p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="no">df2</span> <span class="kw">&lt;-</span>
  <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>( <span class="co"># creating the 'non-appearance points' variable based on goals, assists, saves, penalty saves, and bonus points, with the exact scoring diferent for each position (element_type)</span>
    <span class="kw">napts</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(
      <span class="no">element_type</span> <span class="kw">==</span> <span class="fl">1</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">goals_scored</span> * <span class="fl">6</span> + <span class="no">assists</span> * <span class="fl">3</span> + <span class="no">saves</span>/<span class="fl">3</span> + <span class="no">penalties_saved</span>*<span class="fl">6</span> + <span class="no">bonus</span>,<span class="fl">0</span>),
      <span class="no">element_type</span> <span class="kw">==</span> <span class="fl">2</span> ~ <span class="no">goals_scored</span> * <span class="fl">6</span> + <span class="no">assists</span> * <span class="fl">3</span> + <span class="no">bonus</span>,
      <span class="no">element_type</span> <span class="kw">==</span> <span class="fl">3</span> ~ <span class="no">goals_scored</span> * <span class="fl">5</span> + <span class="no">assists</span> * <span class="fl">3</span> + <span class="no">bonus</span>,
      <span class="no">element_type</span> <span class="kw">==</span> <span class="fl">4</span> ~ <span class="no">goals_scored</span> * <span class="fl">4</span> + <span class="no">assists</span> * <span class="fl">3</span> + <span class="no">bonus</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">team</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">teamtotal</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">napts</span>)) <span class="kw">%&gt;%</span> <span class="co"># summarising team totals</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">naptsprop</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">napts</span>/<span class="no">teamtotal</span>,<span class="fl">2</span>)) <span class="kw">%&gt;%</span> <span class="co"># calculating the player proportion of the team total (and rounding) </span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="fl">1</span>) <span class="co"># selecting the top player from each team</span></pre></body></html></div>
<p>Finally, we create a nice-looking plot of our data, using ggplot2:</p>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="no">df2</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">second_name</span>,<span class="no">naptsprop</span>),<span class="kw">y</span><span class="kw">=</span><span class="no">naptsprop</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span><span class="kw">=</span><span class="st">"Who Got The Assists?'s Talisman Theory"</span>, <span class="kw">x</span><span class="kw">=</span><span class="st">"Player"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Proportion of team's non-appearance points scored"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-57-1.png" width="672"></p>
<hr>
</div>
<div id="list-of-top-performers-by-fpl-goals-and-assists" class="section level2">
<h2 class="hasAnchor">
<a href="#list-of-top-performers-by-fpl-goals-and-assists" class="anchor"></a>List of top performers by FPL goals and assists</h2>
<p>Suppose we are interested in listing the top FPL performers by FPL goals and assists? Again, we take the first 25 gameweeks of the 18/19 season as an example.</p>
<p>First we fetch the gameweek-by-gameweek details of ALL players using get_player_details:</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_player_details.html">get_player_details</a></span>(<span class="kw">season</span><span class="kw">=</span><span class="fl">18</span>) <span class="co"># this may take a while to load as it fetches ALL player details</span></pre></body></html></div>
<p>Next we use dplyr and ggplot2 to transform and plot the data, showing the top performers:</p>
<div class="sourceCode" id="cb67"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb68"><html><body><pre class="r"><span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">round</span> <span class="kw">%in%</span> <span class="fl">1</span>:<span class="fl">25</span>) <span class="kw">%&gt;%</span> <span class="co"># filtering for the GWs we are interested in</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">playername</span>,<span class="no">goals_scored</span>,<span class="no">assists</span>) <span class="kw">%&gt;%</span> <span class="co"># selecting the relevant columns</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">playername</span>) <span class="kw">%&gt;%</span> <span class="co"># transformation to group and summarize the performance at the 'playername' variable level</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all</a></span>(<span class="no">sum</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="st">"involvements"</span><span class="kw">=</span><span class="no">goals_scored</span>+<span class="no">assists</span>) <span class="kw">%&gt;%</span> <span class="co"># adding a new variable that sums the goals scored and assists</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(-<span class="no">involvements</span>) <span class="kw">%&gt;%</span>  <span class="co"># ordering (arranging) the table by top involvements</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="fl">1</span>:<span class="fl">20</span>) <span class="co"># showing the top20 only</span></pre></body></html></div>
<pre><code>## # A tibble: 20 x 4
##    playername                    goals_scored assists involvements
##    &lt;chr&gt;                                &lt;int&gt;   &lt;int&gt;        &lt;int&gt;
##  1 Mohamed Salah                           16       8           24
##  2 Eden Hazard                             12      10           22
##  3 Raheem Sterling                         10      12           22
##  4 Sergio Agüero                           14       8           22
##  5 Pierre-Emerick Aubameyang               15       6           21
##  6 Harry Kane                              14       6           20
##  7 Leroy Sané                               8      11           19
##  8 Callum Wilson                           10       8           18
##  9 Paul Pogba                               9       9           18
## 10 Alexandre Lacazette                      9       8           17
## 11 Heung-Min Son                           10       7           17
## 12 Marcus Rashford                          9       7           16
## 13 Raúl Jiménez                             9       7           16
## 14 Roberto Firmino                          9       5           14
## 15 Ryan Fraser                              5       9           14
## 16 Aleksandar Mitrovic                     10       3           13
## 17 Sadio Mané                              11       2           13
## 18 Christian Eriksen                        4       8           12
## 19 Felipe Anderson Pereira Gomes            8       4           12
## 20 Gylfi Sigurdsson                         9       3           12</code></pre>
<hr>
</div>
<div id="visualizing-the-fpl-histories-of-entries" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-fpl-histories-of-entries" class="anchor"></a>Visualizing the FPL histories of entries</h2>
<p>Suppose now we are interested in visualizing the FPL history of two entries.</p>
<p>First we fetch the entry histories of two random entries using get_entry_hist:</p>
<div class="sourceCode" id="cb70"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">fplscrapR</span>)

<span class="no">entryhist</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_entry_hist.html">get_entry_hist</a></span>(<span class="kw">entryid</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1001</span>,<span class="fl">2002</span>))</pre></body></html></div>
<p>Next we plot the historical performance using dplyr and ggplot2:</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div class="sourceCode" id="cb72"><html><body><pre class="r"><span class="no">entryhist</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">season_name</span>,<span class="kw">y</span><span class="kw">=</span><span class="no">rank</span>,<span class="kw">group</span><span class="kw">=</span><span class="no">name</span>,<span class="kw">colour</span><span class="kw">=</span><span class="no">name</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span><span class="kw">=</span><span class="st">"top"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Season"</span>,<span class="kw">y</span><span class="kw">=</span><span class="st">"Overall Rank"</span>,<span class="kw">caption</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data from fplscrapR | "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(),<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>))</pre></body></html></div>
<p><img src="allvignettes_files/figure-html/unnamed-chunk-63-1.png" width="672"></p>
<hr>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
